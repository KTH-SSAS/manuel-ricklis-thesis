package test;

import core.Asset;
import core.AttackStep;
import core.AttackStepMax;
import core.AttackStepMin;
import core.Defense;
import java.lang.Boolean;
import java.lang.Override;
import java.lang.String;
import java.util.HashSet;
import java.util.Set;

public abstract class Vulnerability extends Asset {
  public UserInteracts userInteracts;

  public Remove remove;

  public AttemptAbuse attemptAbuse;

  public Abuse abuse;

  public Impact impact;

  private Set<Application> _cacheallVulnerableSoftwareVulnerability;

  private Set<Application> _cachereverseallAutomaticVulnerabilitiesApplication;

  public Object object = null;

  public System system = null;

  public Application application = null;

  public SoftwareProduct softwareProduct = null;

  public Set<Exploit> exploits = new HashSet<>();

  public Vulnerability(String name, boolean isUserInteractsEnabled, boolean isRemoveEnabled) {
    super(name);
    assetClassName = "Vulnerability";
    if (userInteracts != null) {
      AttackStep.allAttackSteps.remove(userInteracts.disable);
    }
    Defense.allDefenses.remove(userInteracts);
    userInteracts = new UserInteracts(name, isUserInteractsEnabled);
    if (remove != null) {
      AttackStep.allAttackSteps.remove(remove.disable);
    }
    Defense.allDefenses.remove(remove);
    remove = new Remove(name, isRemoveEnabled);
    AttackStep.allAttackSteps.remove(attemptAbuse);
    attemptAbuse = new AttemptAbuse(name);
    AttackStep.allAttackSteps.remove(abuse);
    abuse = new Abuse(name);
    AttackStep.allAttackSteps.remove(impact);
    impact = new Impact(name);
  }

  public Vulnerability(String name) {
    super(name);
    assetClassName = "Vulnerability";
    if (userInteracts != null) {
      AttackStep.allAttackSteps.remove(userInteracts.disable);
    }
    Defense.allDefenses.remove(userInteracts);
    userInteracts = new UserInteracts(name, false);
    if (remove != null) {
      AttackStep.allAttackSteps.remove(remove.disable);
    }
    Defense.allDefenses.remove(remove);
    remove = new Remove(name, false);
    AttackStep.allAttackSteps.remove(attemptAbuse);
    attemptAbuse = new AttemptAbuse(name);
    AttackStep.allAttackSteps.remove(abuse);
    abuse = new Abuse(name);
    AttackStep.allAttackSteps.remove(impact);
    impact = new Impact(name);
  }

  public Vulnerability(boolean isUserInteractsEnabled, boolean isRemoveEnabled) {
    this("Anonymous", isUserInteractsEnabled, isRemoveEnabled);
  }

  public Vulnerability() {
    this("Anonymous");
  }

  protected Set<Application> _allVulnerableSoftwareVulnerability() {
    if (_cacheallVulnerableSoftwareVulnerability == null) {
      _cacheallVulnerableSoftwareVulnerability = new HashSet<>();
      Set<Application> _3 = new HashSet<>();
      Set<Application> _4 = new HashSet<>();
      if (application != null) {
        _3.add(application);
      }
      if (softwareProduct != null) {
        for (Application _5 : softwareProduct.softApplications) {
          _4.add(_5);
        }
      }
      _3.addAll(_4);
      for (Application _6 : _3) {
        _cacheallVulnerableSoftwareVulnerability.add(_6);
      }
    }
    return _cacheallVulnerableSoftwareVulnerability;
  }

  protected Set<Application> _reverseallAutomaticVulnerabilitiesApplication() {
    if (_cachereverseallAutomaticVulnerabilitiesApplication == null) {
      _cachereverseallAutomaticVulnerabilitiesApplication = new HashSet<>();
      Set<Application> _7 = new HashSet<>();
      Set<Application> _8 = new HashSet<>();
      if (Vulnerability.this instanceof UnknownVulnerability) {
        for (var _9 : ((test.UnknownVulnerability) Vulnerability.this)._reverseallUnknownVulnerabilitiesApplication()) {
          _7.add(_9);
        }
      }
      Set<Application> _a = new HashSet<>();
      Set<Application> _b = new HashSet<>();
      if (Vulnerability.this instanceof ManuallyModeledVulnerability) {
        for (var _c : ((test.ManuallyModeledVulnerability) Vulnerability.this)._reverseallManualVulnerabilitiesApplication()) {
          _a.add(_c);
        }
      }
      Set<Application> _d = new HashSet<>();
      Set<Application> _e = new HashSet<>();
      if (softwareProduct != null) {
        for (Application _f : softwareProduct.softApplications) {
          _d.add(_f);
        }
      }
      if (application != null) {
        _e.add(application);
      }
      _d.addAll(_e);
      for (Application _10 : _d) {
        _b.add(_10);
      }
      _a.removeAll(_b);
      for (Application _11 : _a) {
        _8.add(_11);
      }
      _7.removeAll(_8);
      for (Application _12 : _7) {
        _cachereverseallAutomaticVulnerabilitiesApplication.add(_12);
      }
    }
    return _cachereverseallAutomaticVulnerabilitiesApplication;
  }

  public void addObject(Object object) {
    this.object = object;
    object.objvulnerabilities.add(this);
  }

  public void addSystem(System system) {
    this.system = system;
    system.sysvulnerabilities.add(this);
  }

  public void addApplication(Application application) {
    this.application = application;
    application.vulnerabilities.add(this);
  }

  public void addSoftwareProduct(SoftwareProduct softwareProduct) {
    this.softwareProduct = softwareProduct;
    softwareProduct.softProductVulnerabilities.add(this);
  }

  public void addExploits(Exploit exploits) {
    this.exploits.add(exploits);
    exploits.vulnerability = this;
  }

  @Override
  public String getAssociatedAssetClassName(String field) {
    if (field.equals("object")) {
      return Object.class.getName();
    } else if (field.equals("system")) {
      return System.class.getName();
    } else if (field.equals("application")) {
      return Application.class.getName();
    } else if (field.equals("softwareProduct")) {
      return SoftwareProduct.class.getName();
    } else if (field.equals("exploits")) {
      return Exploit.class.getName();
    }
    return "";
  }

  @Override
  public Set<Asset> getAssociatedAssets(String field) {
    Set<Asset> assets = new HashSet<>();
    if (field.equals("object")) {
      if (object != null) {
        assets.add(object);
      }
    } else if (field.equals("system")) {
      if (system != null) {
        assets.add(system);
      }
    } else if (field.equals("application")) {
      if (application != null) {
        assets.add(application);
      }
    } else if (field.equals("softwareProduct")) {
      if (softwareProduct != null) {
        assets.add(softwareProduct);
      }
    } else if (field.equals("exploits")) {
      assets.addAll(exploits);
    }
    return assets;
  }

  @Override
  public Set<Asset> getAllAssociatedAssets() {
    Set<Asset> assets = new HashSet<>();
    if (object != null) {
      assets.add(object);
    }
    if (system != null) {
      assets.add(system);
    }
    if (application != null) {
      assets.add(application);
    }
    if (softwareProduct != null) {
      assets.add(softwareProduct);
    }
    assets.addAll(exploits);
    return assets;
  }

  public class UserInteracts extends Defense {
    public UserInteracts(String name) {
      this(name, false);
    }

    public UserInteracts(String name, Boolean isEnabled) {
      super(name);
      defaultValue = isEnabled;
      disable = new Disable(name);
    }

    public class Disable extends AttackStepMin {
      public Disable(String name) {
        super(name);
      }

      @Override
      public String fullName() {
        return "Vulnerability.userInteracts";
      }
    }
  }

  public class Remove extends Defense {
    public Remove(String name) {
      this(name, false);
    }

    public Remove(String name, Boolean isEnabled) {
      super(name);
      defaultValue = isEnabled;
      disable = new Disable(name);
    }

    public class Disable extends AttackStepMin {
      private Set<AttackStep> _cacheChildrenRemove;

      public Disable(String name) {
        super(name);
      }

      @Override
      public void updateChildren(Set<AttackStep> attackSteps) {
        if (_cacheChildrenRemove == null) {
          _cacheChildrenRemove = new HashSet<>();
          _cacheChildrenRemove.add(abuse);
        }
        for (AttackStep attackStep : _cacheChildrenRemove) {
          attackStep.updateTtc(this, ttc, attackSteps);
        }
      }

      @Override
      public String fullName() {
        return "Vulnerability.remove";
      }
    }
  }

  public class AttemptAbuse extends AttackStepMin {
    private Set<AttackStep> _cacheChildrenAttemptAbuse;

    private Set<AttackStep> _cacheParentAttemptAbuse;

    public AttemptAbuse(String name) {
      super(name);
    }

    @Override
    public void updateChildren(Set<AttackStep> attackSteps) {
      if (_cacheChildrenAttemptAbuse == null) {
        _cacheChildrenAttemptAbuse = new HashSet<>();
        _cacheChildrenAttemptAbuse.add(abuse);
      }
      for (AttackStep attackStep : _cacheChildrenAttemptAbuse) {
        attackStep.updateTtc(this, ttc, attackSteps);
      }
    }

    @Override
    public void setExpectedParents() {
      super.setExpectedParents();
      if (_cacheParentAttemptAbuse == null) {
        _cacheParentAttemptAbuse = new HashSet<>();
        if (object != null) {
          _cacheParentAttemptAbuse.add(object.attemptUseVulnerability);
        }
        if (system != null) {
          _cacheParentAttemptAbuse.add(system.attemptUsePhysicalVulnerability);
        }
        if (Vulnerability.this instanceof ManuallyModeledVulnerability) {
          for (var _0 : ((test.ManuallyModeledVulnerability) Vulnerability.this)._reverseallManualVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_0.attemptUseVulnerability);
          }
        }
        if (Vulnerability.this instanceof UnknownVulnerability) {
          for (var _1 : ((test.UnknownVulnerability) Vulnerability.this)._reverseallUnknownVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_1.attemptUseVulnerability);
          }
        }
        if (Vulnerability.this instanceof LLNNVulnerability) {
          for (var _2 : ((test.LLNNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_2.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LLNRVulnerability) {
          for (var _3 : ((test.LLNRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_3.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LLLNVulnerability) {
          for (var _4 : ((test.LLLNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_4.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LLLRVulnerability) {
          for (var _5 : ((test.LLLRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_5.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LLHNVulnerability) {
          for (var _6 : ((test.LLHNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_6.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LLHRVulnerability) {
          for (var _7 : ((test.LLHRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_7.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LHNNVulnerability) {
          for (var _8 : ((test.LHNNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_8.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LHNRVulnerability) {
          for (var _9 : ((test.LHNRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_9.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LHLNVulnerability) {
          for (var _a : ((test.LHLNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_a.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LHLRVulnerability) {
          for (var _b : ((test.LHLRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_b.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LHHNVulnerability) {
          for (var _c : ((test.LHHNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_c.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof LHHRVulnerability) {
          for (var _d : ((test.LHHRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_d.attemptLocalConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NLNNVulnerability) {
          for (var _e : ((test.NLNNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_e.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NLNRVulnerability) {
          for (var _f : ((test.NLNRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_f.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NLLNVulnerability) {
          for (var _10 : ((test.NLLNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_10.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NLLRVulnerability) {
          for (var _11 : ((test.NLLRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_11.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NLHNVulnerability) {
          for (var _12 : ((test.NLHNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_12.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NLHRVulnerability) {
          for (var _13 : ((test.NLHRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_13.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NHNNVulnerability) {
          for (var _14 : ((test.NHNNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_14.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NHNRVulnerability) {
          for (var _15 : ((test.NHNRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_15.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NHLNVulnerability) {
          for (var _16 : ((test.NHLNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_16.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NHLRVulnerability) {
          for (var _17 : ((test.NHLRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_17.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NHHNVulnerability) {
          for (var _18 : ((test.NHHNVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_18.attemptNetworkRequestRespondConnectVuln);
          }
        }
        if (Vulnerability.this instanceof NHHRVulnerability) {
          for (var _19 : ((test.NHHRVulnerability) Vulnerability.this)._reverseallAutomaticVulnerabilitiesApplication()) {
            _cacheParentAttemptAbuse.add(_19.attemptNetworkRequestRespondConnectVuln);
          }
        }
      }
      for (AttackStep attackStep : _cacheParentAttemptAbuse) {
        addExpectedParent(attackStep);
      }
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("Vulnerability.attemptAbuse");
    }
  }

  public class Abuse extends AttackStepMax {
    private Set<AttackStep> _cacheChildrenAbuse;

    private Set<AttackStep> _cacheParentAbuse;

    public Abuse(String name) {
      super(name);
    }

    @Override
    public void updateChildren(Set<AttackStep> attackSteps) {
      if (_cacheChildrenAbuse == null) {
        _cacheChildrenAbuse = new HashSet<>();
        for (Exploit _0 : exploits) {
          _cacheChildrenAbuse.add(_0.attemptExploit);
        }
      }
      for (AttackStep attackStep : _cacheChildrenAbuse) {
        attackStep.updateTtc(this, ttc, attackSteps);
      }
    }

    @Override
    public void setExpectedParents() {
      super.setExpectedParents();
      if (_cacheParentAbuse == null) {
        _cacheParentAbuse = new HashSet<>();
        _cacheParentAbuse.add(remove.disable);
        _cacheParentAbuse.add(attemptAbuse);
        if (Vulnerability.this instanceof ManuallyModeledVulnerability) {
          _cacheParentAbuse.add(((test.ManuallyModeledVulnerability) Vulnerability.this).userInteracts.disable);
        }
      }
      for (AttackStep attackStep : _cacheParentAbuse) {
        addExpectedParent(attackStep);
      }
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("Vulnerability.abuse");
    }
  }

  public class Impact extends AttackStepMin {
    private Set<AttackStep> _cacheParentImpact;

    public Impact(String name) {
      super(name);
    }

    @Override
    public void setExpectedParents() {
      super.setExpectedParents();
      if (_cacheParentImpact == null) {
        _cacheParentImpact = new HashSet<>();
        for (Exploit _0 : exploits) {
          _cacheParentImpact.add(_0.attemptExploit);
        }
        for (Exploit _1 : exploits) {
          if (_1 instanceof ManualHighComplexityExploit) {
            _cacheParentImpact.add(((test.ManualHighComplexityExploit) _1).attemptExploit);
          }
        }
        for (Exploit _2 : exploits) {
          if (_2 instanceof ManualLowComplexityExploit) {
            _cacheParentImpact.add(((test.ManualLowComplexityExploit) _2).attemptExploit);
          }
        }
      }
      for (AttackStep attackStep : _cacheParentImpact) {
        addExpectedParent(attackStep);
      }
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("Vulnerability.impact");
    }
  }
}
