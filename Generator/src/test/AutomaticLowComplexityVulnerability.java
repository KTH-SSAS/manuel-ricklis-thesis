package test;

import core.AttackStep;
import java.lang.Override;
import java.lang.String;
import java.util.HashSet;
import java.util.Set;

public abstract class AutomaticLowComplexityVulnerability extends AutomaticallyModeledVulnerability {
  public AutomaticLowComplexityVulnerability(String name, boolean isUserInteractsEnabled,
      boolean isRemoveEnabled) {
    super(name, isUserInteractsEnabled, isRemoveEnabled);
    assetClassName = "AutomaticLowComplexityVulnerability";
    AttackStep.allAttackSteps.remove(abuse);
    abuse = new Abuse(name);
  }

  public AutomaticLowComplexityVulnerability(String name) {
    super(name);
    assetClassName = "AutomaticLowComplexityVulnerability";
    AttackStep.allAttackSteps.remove(abuse);
    abuse = new Abuse(name);
  }

  public AutomaticLowComplexityVulnerability(boolean isUserInteractsEnabled,
      boolean isRemoveEnabled) {
    this("Anonymous", isUserInteractsEnabled, isRemoveEnabled);
  }

  public AutomaticLowComplexityVulnerability() {
    this("Anonymous");
  }

  public class Abuse extends Vulnerability.Abuse {
    private Set<AttackStep> _cacheChildrenAbuse;

    private Set<AttackStep> _cacheParentAbuse;

    public Abuse(String name) {
      super(name);
    }

    @Override
    public void updateChildren(Set<AttackStep> attackSteps) {
      if (_cacheChildrenAbuse == null) {
        _cacheChildrenAbuse = new HashSet<>();
        if (AutomaticLowComplexityVulnerability.this instanceof AutomaticLowComplexityVulnerability) {
          for (Exploit _0 : ((test.AutomaticLowComplexityVulnerability) AutomaticLowComplexityVulnerability.this).exploits) {
            _cacheChildrenAbuse.add(_0.attemptExploit);
          }
        }
      }
      for (AttackStep attackStep : _cacheChildrenAbuse) {
        attackStep.updateTtc(this, ttc, attackSteps);
      }
    }

    @Override
    public void setExpectedParents() {
      super.setExpectedParents();
      if (_cacheParentAbuse == null) {
        _cacheParentAbuse = new HashSet<>();
        if (AutomaticLowComplexityVulnerability.this instanceof LLNRVulnerability) {
          _cacheParentAbuse.add(((test.LLNRVulnerability) AutomaticLowComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticLowComplexityVulnerability.this instanceof LLLRVulnerability) {
          _cacheParentAbuse.add(((test.LLLRVulnerability) AutomaticLowComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticLowComplexityVulnerability.this instanceof LLHRVulnerability) {
          _cacheParentAbuse.add(((test.LLHRVulnerability) AutomaticLowComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticLowComplexityVulnerability.this instanceof NLNRVulnerability) {
          _cacheParentAbuse.add(((test.NLNRVulnerability) AutomaticLowComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticLowComplexityVulnerability.this instanceof NLLRVulnerability) {
          _cacheParentAbuse.add(((test.NLLRVulnerability) AutomaticLowComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticLowComplexityVulnerability.this instanceof NLHRVulnerability) {
          _cacheParentAbuse.add(((test.NLHRVulnerability) AutomaticLowComplexityVulnerability.this).userInteracts.disable);
        }
      }
      for (AttackStep attackStep : _cacheParentAbuse) {
        addExpectedParent(attackStep);
      }
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("AutomaticLowComplexityVulnerability.abuse");
    }
  }
}
